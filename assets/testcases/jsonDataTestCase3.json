{
  "authorization": [
    {
      "role": "Projektverantwortlicher",
      "activity": "edit"
    }
  ],
  "identity": {
    "name": "createInvoice",
    "designation": "Rechnung stellen",
    "description": "Hier erstellst du eine Abschluss- oder auch Zwischenrechnung für ein Projekts. \nGeneriere eine Rechnung an deine Kunden, die sich automatisch aus den verbuchten Projektleistungen (Eigen- wie Fremdleistungen), den hinterlegten Zahlungskonditionen (Rabattklassen, Einzel- oder Sammelrechnung u.ä.) der Kund*in, den bereits erbrachten Zahlungen (Vorauszahlung, Zwischenrechnungen usw.) und den ggf. getroffenen Sondervereinbarungen zusammensetzt.",
    "circle": "Purpose",
    "domain": "Accounting"
  },
  "input": {
    "class": [
      {
        "name": "project",
        "selection": "project"
      },
      {
        "name": "projectHours",
        "destination": "project.projectHours"
      },
      {
        "name": "thirdPartyCost",
        "destination": "project.thirdPartyCost"
      }
    ]
  },
  "output": {
    "class": [
      {
        "name": "invoice",
        "designation": "Rechnung",
        "display": [
          {
            "type": "list",
            "refItem": [
              "date",
              "invoiceId"
            ]
          }
        ],
        "item": [
          {
            "name": "invoiceId",
            "designation": "Rechnung Nr.",
            "type": "string",
            "properties": {
              "required": true,
              "unique": true,
              "value": {
                "concatenation": [
                  {
                    "constant": "RE"
                  },
                  {
                    "constant": " "
                  },
                  {
                    "variable": "year"
                  },
                  {
                    "refItemNext": {
                      "refItem": "invoiceId",
                      "offset": "7,4",
                      "type": "table",
                      "step": 1,
                      "base": 0
                    }
                  }
                ]
              }
            }
          },
          {
            "name": "date",
            "designation": "Rechnungsdatum",
            "type": "date"
          }
        ],
        "list": [
          {
            "name": "projectHours",
            "designation": "Projektstunden",
            "type": "array",
            "item": [
              {
                "name": "projectHours",
                "designation": "Projektstunden",
                "type": "object",
                "refClass": "projectHours",
                "properties": {
                  "unique": true
                }
              },
              {
                "name": "activity",
                "designation": "Tätigkeit",
                "type": "object",
                "refClass": "activity"
              },
              {
                "name": "description",
                "designation": "Beschreibung",
                "type": "string",
                "refItem": "activity",
                "properties": {
                  "value": {
                    "refItem": "$input.description"
                  },
                  "format": "textarea"
                }
              },
              {
                "name": "quantity",
                "designation": "Menge",
                "type": "number",
                "properties": {
                  "decimals": 1,
                  "unit": {
                    "refItem": "unit"
                  }
                }
              },
              {
                "name": "price",
                "designation": "Preis pro Stunde",
                "type": "number",
                "properties": {
                  "decimals": 2,
                  "currency": {},
                  "value": {
                    "refItem": "$input.price"
                  }
                }
              }
            ]
          },
          {
            "name": "thirdPartyCost",
            "designation": "Fremdkosten",
            "type": "array",
            "item": [
              {
                "name": "thirdPartyCost",
                "designation": "Fremdkosten",
                "type": "object",
                "refClass": "thirdPartyCost",
                "properties": {
                  "unique": true
                }
              },
              {
                "name": "description",
                "designation": "Beschreibung",
                "type": "string",
                "refItem": "thirdPartyCost",
                "properties": {
                  "value": {
                    "refItem": "$input.description"
                  },
                  "format": "textarea"
                }
              },
              {
                "name": "quantity",
                "designation": "Menge",
                "type": "number",
                "properties": {
                  "decimals": 1,
                  "unit": {
                    "refItem": "unit"
                  }
                }
              },
              {
                "name": "unit",
                "designation": "Einheit",
                "type": "object",
                "refClass": "unit",
                "properties": {
                  "value": {
                    "refItem": "$input.unit"
                  }
                }
              },
              {
                "name": "price",
                "designation": "Preis",
                "type": "number",
                "properties": {
                  "decimals": 2,
                  "currency": {},
                  "value": {
                    "refItem": "$input.price"
                  }
                }
              }
            ]
          }
        ]
      }
    ]
  },
  "result": {
    "resultDef": [
      {
        "template": "Rechnung",
        "service": "pdf",
        "transport": {
          "destinationItem": "invoice.customer.contact.email",
          "type": "email"
        }
      }
    ]
  },
  "state": {
    "direction": "Purpose",
    "task": "Compensation",
    "step": "Preparation"
  },
  "trigger": {
    "startOn": [
      {
        "type": "Manual"
      }
    ]
  },
  "validity": {}
}